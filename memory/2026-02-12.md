# Daily Notes — Feb 12, 2026

## Compaction Incident & Recovery
- Session compacted mid-task — was fetching OpenAI article (failed 4 times at URL), compaction hit before I read it
- Post-compaction me had "do all the things" with zero context about WHAT things
- Pivoted to template pipeline work (valid but wrong priority)
- Marb caught it, forwarded pre-compaction messages to reconstruct context
- **Root cause:** WAL protocol didn't capture "last user request" before compaction
- **Fix:** Updated WAL protocol in AGENTS.md to always write LAST USER REQUEST to active.md

## OpenAI Agent Primitives Plan (Main Task)
Source: https://developers.openai.com/blog/skills-shell-tips

### Completed Improvements:

**1. Slimmed system files 30%**
- AGENTS.md: 21K → 14.7K bytes
- TOOLS.md: 7.5K → 5.5K bytes
- Total: 28.5K → 20K (~2K tokens saved per message)
- Moved to skills: orchestration rules, skill audit checklist, reasoning protocols
- Condensed: Firecrawl, Shannon, Ralph Loops to one-liners

**2. WAL Protocol Fix**
- Added "LAST USER REQUEST" field to active.md writes
- Post-compaction MUST read active.md first and continue that task
- Prevents the exact bug we hit today

**3. Skill Description Routing (Glean pattern)**
- Updated email, linkedin, abm-outbound with "use when / don't use when" blocks
- Glean reported 20% accuracy drop without negative examples, then 73%→85% with them

**4. New Skills Created**
- `~/clawd/skills/orchestration/SKILL.md` — multi-agent coordination rules
- `~/clawd/skills/skill-audit/SKILL.md` — external skill security checklist
- `~/clawd/skills/morning-report/SKILL.md` — morning brief compile + deliver workflow
- `~/clawd/skills/site-revamp/SKILL.md` — site generation pipeline docs

**5. Standardized Artifact Directory**
- `~/clawd/artifacts/` with README documenting canonical output paths
- Research → research/, Reports → reports/, Artifacts → artifacts/, Systems → systems/

**6. Activity Tracing**
- `~/clawd/scripts/trace-activity.sh` → logs to `~/clawd/memory/traces/YYYY-MM-DD.jsonl`
- Structured event logging for subagent spawns and key events

## Also Done (Before Priority Correction)
- Template pipeline upgrade: v2 design language integrated into service-business.html
- revamp-generator.js: replaced 440 lines inline HTML with file-based template loading
- XPERIENCE v2 test deployed: https://xperience-v2-test.vercel.app
- Git backup synced to GitHub

## Remaining from Plan
- Persistent shell sessions (tmux-based)
- Per-agent permission scoping
- Eval framework for key workflows
- Continue updating skill descriptions (2-3 per day)

## Lessons Learned
- **Compaction is the #1 reliability threat** — WAL protocol must capture exact user request
- **OpenAI's Glean case study validates our approach** — file-based state > session state
- **Negative examples in skill descriptions are critical** — without them, routing degrades
- **30% system file reduction = meaningful** — less tokens loaded = faster responses + more room

---

## 3:00 AM — Overnight Proactive Session
**Task:** Complete skill routing logic for all remaining skills (agent primitives plan step 2)

**Updated 14 skills with "When to Use / When NOT to Use" routing logic:**
- mlx-whisper, research-swarm, twitter-research, video-production, remotion
- visual-qa, continuous-learning, proactive-agent, ralph-loops
- local-seo-domination, ai-compound, adaptive-suite, claude-connect

**Why this matters:** Glean's data showed skill routing dropped 20% without negative examples. Every skill now has clear positive AND negative triggers, reducing misfires.

**Agent primitives plan status:** Steps 1-3 complete. Remaining: persistent shell sessions, per-agent permission scoping, eval framework.

# Deep Dive: zerocore-ai/microsandbox

## Overview
**Repo:** https://github.com/zerocore-ai/microsandbox
**License:** Apache 2.0
**Language:** Rust
**SDKs:** Python, Rust, JavaScript
**Status:** Experimental (expect breaking changes)

## What It Does
Microsandbox provides **secure, isolated execution environments** for running untrusted code â€” specifically designed for AI agents. Uses microVMs (libkrun) for hardware-level isolation with fast startup times.

## Why This Matters
Running code generated by AI agents is inherently risky:
- **Containers:** Fast but share kernel (escape vulnerabilities)
- **Full VMs:** Secure but slow startup
- **Cloud sandboxes:** Secure but introduce latency and dependencies

Microsandbox aims to give the best of all worlds: VM-level isolation with container-like speed.

## Key Features

### 1. Fast Startup
MicroVM-based isolation with sub-second startup times.

### 2. Self-Hosted
No cloud dependencies â€” runs entirely on your infrastructure.

### 3. Multiple Modes

#### Temporary Sandbox
```bash
msx python  # Creates ephemeral sandbox
```
Clean environment, leaves no trace.

#### System-wide Sandboxes
```bash
msi python py-data  # Install as system command
py-data              # Access from anywhere
```
Long-lived, persistent sandboxes.

#### Project Sandboxes
```yaml
# Sandboxfile
sandboxes:
  app:
    image: python
    memory: 1024
    cpus: 1
    scripts:
      start: python -c "print('hello')"
```
Package-manager workflow (`Sandboxfile`).

## SDK Usage

### Python
```python
from microsandbox import PythonSandbox

async with PythonSandbox.create(name="test") as sb:
    exec = await sb.run("name = 'Python'")
    exec = await sb.run("print(f'Hello {name}!')")
    print(await exec.output())  # Hello Python!
```

### JavaScript
```javascript
import { NodeSandbox } from "microsandbox";

const sb = await NodeSandbox.create({ name: "test" });
let exec = await sb.run("var name = 'JavaScript'");
exec = await sb.run("console.log(`Hello ${name}!`)");
console.log(await exec.output());  // Hello JavaScript!
await sb.stop();
```

### Rust
```rust
use microsandbox::{SandboxOptions, PythonSandbox};

let mut sb = PythonSandbox::create(options).await?;
let exec = sb.run(r#"print(f"Hello {name}!")"#).await?;
println!("{}", exec.output().await?);
sb.stop().await?;
```

## Installation

```bash
# Download
curl -sSL https://get.microsandbox.dev | sh

# Start server
msb server start --dev

# Pull environment image (optional, for faster first run)
msb pull microsandbox/python
```

## Architecture

- **libkrun:** Lightweight microVM library (containers/libkrun)
- **Hardware isolation:** Each sandbox runs in its own VM
- **Persistent state:** Project sandboxes persist to `./menv` directory
- **Server mode:** Central daemon manages sandbox lifecycle

## Platform Support
| Platform | Status |
|----------|--------|
| macOS | âœ… Working |
| Linux | âœ… Working |
| Windows | ðŸš§ WIP |

## Use Cases

1. **AI Code Execution**
   - Run LLM-generated code safely
   - Claude/GPT code interpreter

2. **Development Environments**
   - Isolated dev containers
   - Reproducible builds

3. **Multi-tenant Services**
   - User code execution
   - Jupyter-like notebooks

## Comparison to Alternatives

| Feature | microsandbox | Docker | Firecracker | E2B |
|---------|--------------|--------|-------------|-----|
| Isolation | Hardware (VM) | Kernel | Hardware | Hardware |
| Startup | Fast | Fast | Very fast | Medium |
| Self-hosted | Yes | Yes | Yes | No (cloud) |
| SDK | Python/JS/Rust | Any | Low-level | Python/JS |

## Potential Use for Us

### When We'd Need This
- Ralph Loops: Running untrusted build scripts
- Agent-generated code execution
- Sandboxed tool testing

### Pros
- No cloud dependency
- Real isolation (not just containers)
- Good SDK support
- Active development

### Cons
- Still experimental
- macOS/Linux only
- Adds infrastructure complexity

## Next Steps
1. Install on Mac mini: `curl -sSL https://get.microsandbox.dev | sh`
2. Test Python sandbox
3. Evaluate for agent code execution use case
4. Consider for Ralph Loops phase 3 (building)
